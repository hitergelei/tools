# Sample LAMMPS input script for thermal conductivity of solid Ar

units       metal
variable    T equal 300
variable    T2 equal $T*1.
variable    dt equal 0.01
variable    s equal 1    # sample interval
variable    p equal 50000    # correlation length
variable    d equal 200000    # dump interval

# @ convert from LAMMPS metal units to SI
variable    kB equal 8.61733034e-5    # [eV/K] Boltzmann
variable    e equal 1.60218e-19
variable    eV2J equal $e
variable    ps2s equal 1.0e-12
variable    A2m equal 1.0e-10
variable    convert equal ${eV2J}/${ps2s}/${A2m} # [W/mK] = [J/smK]

# setup problem

package      omp 4
dimension    3
boundary     p p p
newton       off
box          tilt large
read_data    structure.in
mass         1 72.64
mass         2 127.60
pair_style   nequip
pair_coeff   * * ../../../../../frozen_model.pb Ge Te
#pair_style   deepmd frozen_model.pb
#pair_coeff   * *
#pair_style   tersoff
#pair_coeff   * * Si.tersoff Si
timestep     ${dt}
thermo_style custom step etotal ke temp pe press vol
thermo_modify   format float %.15g
thermo       $s

# equilibration and thermalization

velocity     all create ${T2} 13 mom yes dist gaussian
fix          NVT all nvt/omp temp $T $T 1.
compute      1 all pe/atom
dump         0 all custom 100 out.dump id element mass type x y z fx fy fz vx vy vz c_1
dump_modify  0 element Ge Te
run          5000

# thermal conductivity calculation, switch to NVE if desired

reset_timestep 0
compute      myKE all ke/atom
compute      myPE all pe/atom
compute      myStress all stress/atom NULL virial
compute      flux all heat/flux myKE myPE myStress
fix          JJ all ave/correlate $s $p $d &
             c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
thermo_style custom step etotal ke temp pe press vol c_flux[1] c_flux[2] c_flux[3]
thermo_modify   format float %.15g
thermo       $s
run          $d
